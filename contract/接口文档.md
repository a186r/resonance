 接口文档更新日志：

v0.1.8

- 接口`initParamForFirstStep`新增**设置基金会地址（转移合约所有权）**、**设置基金会收款地址**、**设置初始裂变者地址**

v0.1.7

- **每个接口新增请求地址一项**
- **每个接口同时提供event和return两种返回方式**
- 新增**基金会增加Token授权额度**
- 新增**基金会降低Token授权额度**

v0.1.6

- 新增**基金会授权Token额度**
- 新增**基金会查询剩余多少授权额度**

v0.1.5

- 新增**设置当前轮次募资目标**
- 新增**查询所有参与共振的用户地址(只有管理员能调用)**
- 新增**查询单个用户在共振中投入的ETH的总量(只有管理员能调用)**

v0.1.4

- 修改 **结算当前轮次（裂变奖励和幸运奖励）**
- 修改 **获取信仰奖励信息**
- 新增 **结算信仰奖励**
- 新增 **返回下一个区块高度的区块Hash**

v0.1.3

- 新增**查询msg.sender是否是共建者Builder**
- 新增**查询msg.sender是否是募资者Funder**
- 新增**提取所有Token**

v0.1.2

- **结算当前轮次** 接口增加说明
- 更新**查询某轮次Funders**

v0.1.1

- 新增查询接口  **查询某轮次Funder**
- 新增 **结算当前轮次**，**只有管理员能够调用**

v0.1

- 新增  **成为裂变者的接口**(成为裂变者是参与共振的第一步)
- 新增提取所有ETH的接口



## 业务接口

#### 1. 成为裂变者

- 接口名称：toBeFissionPerson

- 请求地址：Resonance合约地址

- 请求参数

  | 请求参数 | 参数类型 | 参数说明 |
  | -------- | -------- | -------- |
  | promoter | address  | 推广人   |

- 返回

  ~~日志名称：ToBeFissionPerson~~

  返回方式：return
  
  | 返回参数 | 参数类型 | 参数说明     |
  | -------- | -------- | ------------ |
  | 0        | address  | 裂变者(用户) |
  | 1        | address  | 推广人       |

#### 2. 提取所有ETH

- 接口名称：withdrawAllETH

- 请求地址：Resonance合约地址

- 请求参数

  无
  
- 返回

  ~~日志名称：WithdrawAllETH~~

  返回方式：return
  
  | Index | 参数类型 | 参数说明      |
  | ----- | -------- | ------------- |
  | 0     | address  | 投资人地址    |
  | 1     | uint256  | 提取的ETH总量 |

#### 3. 提取所有Token

- 接口名称：withdrawAllToken

- 请求地址：Resonance合约地址

- 请求参数：

  无

- 返回

  ~~日志名称：WhihdrawAllToken~~

  返回方式：return
  
  | Index | 参数类型        | 参数说明                                             |
  | ----- | --------------- | ---------------------------------------------------- |
  | 0     | address         | 发送出token的地址，合约地址(因为是从合约中提取token) |
  | 1     | address         | 获得token的地址，msg.sender                          |
  | 2     | 提取的Token数量 | 提取的token数量                                      |


#### 4. 结算当前轮次（裂变奖励和幸运奖励）

募资期结束后结算当前轮次的游戏奖励，只有管理员能够调用。

管理员调用此方法之后 ，会先结算奖励，然后结算收款人可提取的ETH余额，然后进入下一轮 currentStep++

- 接口名称：settlementStep

- 请求地址：Resonance合约地址

- 请求参数：

  | 请求参数           | 参数类型  | 参数说明           |
  | ------------------ | --------- | ------------------ |
  | _fissionWinnerList | address[] | 裂变奖励获胜者列表 |
  | _LuckyWinnerList   | address[] | 幸运奖励获胜者列表 |
  
- 返回

  返回类型：return

  返回值：无

#### 5. 结算信仰奖励

- 接口名称：settlementFaithReward

- 请求地址：Resonance合约地址

- 请求参数：

  | 请求参数         | 参数类型  | 参数说明 |
  | ---------------- | --------- | -------- |
  | _FaithWinnerList | address[] |          |

- 返回

  返回类型：return

  | Index | 返回类型 | 参数说明             |
  | ----- | -------- | -------------------- |
  | 0     | bool     | 信仰奖励是否分配结束 |

#### 6. 设置当前轮次募资目标

- 接口名称：setRaiseTarget

- 请求地址：Resonance合约地址

- 请求参数：

  | 请求参数     | 参数类型 | 参数说明         |
  | ------------ | -------- | ---------------- |
  | _raiseTarget | uint256  | 当前轮次募资目标 |

- 返回：

  返回方式：return

  返回参数：
  
  | Index | 参数类型 | 参数说明         |
  | ----- | -------- | ---------------- |
  | 0     | uint256  | 当前轮次数       |
  | 1     | uint256  | 当前轮次募资目标 |


#### 7. 基金会授权Token额度

- 接口名称：approve

- 请求地址：ABCToken(或者ERC20) 合约地址

- 请求参数：

  | 请求参数 | 参数类型 | 参数说明 |
  | -------- | -------- | -------- |
  | spender  | address  | 授权地址 |
  | value    | uint256  | 授权额度 |

- 返回参数：

  返回方式：return

  | Index | 参数类型 | 参数说明 |
  | ----- | -------- | -------- |
  | 0     | bool     | 授权成功 |

#### 8. 基金会增加Token授权额度

- 接口名称：increaseAllowance

- 请求地址：ABCToken(或者ERC20) 合约地址

- 请求参数：

  | 请求参数    | 参数类型 | 参数说明                               |
  | ----------- | -------- | -------------------------------------- |
  | _spender    | address  | 将花费Token的地址(Resonance合约的地址) |
  | _addedValue | uint256  | 要增加多少额度                         |

- 返回：

  返回方式：return

  | Index | 参数类型 | 参数说明         |
  | ----- | -------- | ---------------- |
  | 0     | bool     | 增加授权额度成功 |

#### 9. 基金会降低Token授权额度

- 接口名称：decreaseAllowance

- 请求地址：ABCToken(或者ERC20) 合约地址

- 请求参数：

  | 请求参数         | 参数类型 | 参数说明                               |
  | ---------------- | -------- | -------------------------------------- |
  | _spender         | address  | 将花费Token的地址(Resonance合约的地址) |
  | _subtractedValue | uint256  | 要减少多少额度                         |

- 返回：

  返回方式：return

  | Index | 参数类型 | 参数说明         |
  | ----- | -------- | ---------------- |
  | 0     | bool     | 减少授权额度成功 |

  

## 查询接口

#### 1. 首页

首页需要查询当前轮次组建期开放多少Token，当前轮次募资期已经募得的ETH

- 接口名称：`getCurrentStepFundsInfo()`

- 请求地址：Resonance合约地址

- 请求参数

  | 请求参数 | 参数类型 | 参数说明 |
  | -------- | -------- | -------- |
  | 无       |          |          |

- 返回

  ~~日志名称：`FundsInfo()~~`

  返回方式：return
  
  | Index | 参数类型 | 参数说明                     |
  | ----- | -------- | ---------------------------- |
  | 0     | uint256  | 当前处于第几轮次             |
  | 1     | uint256  | 当前组建期开放多少Token      |
  | 2     | uint256  | 当前轮次募资期已经募得的以太 |

#### 2. 组建页面

- 接口名称：`getBuildingPerioInfo()`

- 请求地址：Resonance合约地址

- 请求参数

  | 请求参数 | 参数类型 | 参数说明 |
  | -------- | -------- | -------- |
  | 无       |          |          |

- 返回

  ~~日志名称：`BuildingPerioInfo~~`

  返回方式：return
  
  | Index | 参数类型  | 参数说明                          |
  | ----- | --------- | --------------------------------- |
  | 0     | `uint256` | 当前轮次倒计时                    |
  | 1     | `uint256` | 当前轮次剩余Token数量             |
  | 2     | `uint256` | 当前轮次每个地址最多投入多少Token |
  | 3     | `uint256` | 总共募资已投入多少Token           |

#### 3. 募资界面

- 接口名称：`getFundingPeriodInfo()`

- 请求地址：Resonance合约地址

- 请求参数

  | 请求参数 | 参数类型 | 参数说明 |
  | -------- | -------- | -------- |
  | 无       |          |          |

- 返回

  ~~日志名称：`FundingPeriodInfo~~`

  返回方式：return
  
  | Index | 参数类型  | 参数说明                  |
  | ----- | --------- | ------------------------- |
  | 0     | `uint256` | 当前轮次结束倒计时        |
  | 1     | `uint256` | 当前轮次可投入剩余ETH数量 |
  | 2     | `uint256` | 总共已投入多少eth         |

#### 4. 奖励部分

##### 1. 获取某轮次裂变奖励信息

- 接口名称：`getFissionRewardInfo(uint256 _stepIndex)`

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  | 参数名称     | 参数类型  | 参数说明       |
  | ------------ | --------- | -------------- |
  | `_stepIndex` | `uint256` | 第几轮(轮次数) |

- 返回

  ~~日志名称：`FissionRewardInfo`~~

  返回方式：return
  
  | Index | 参数类型  | 参数说明           |
  | ----- | --------- | ------------------ |
  | 0     | uint256   | 当前轮次总奖励金   |
  | 1     | address[] | 裂变奖励获奖者列表 |
  | 2     | uint256[] | 裂变奖励奖金列表   |

##### 2. 获取FOMO奖励信息

- 接口名称：`getFOMORewardIofo(uint256 _stepIndex)`

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  | 参数名称     | 参数类型  | 参数说明       |
  | ------------ | --------- | -------------- |
  | `_stepIndex` | `uint256` | 第几轮(轮次数) |

- 返回

  ~~日志名称：`FOMORewardInfo`~~~~

  返回方式：return
  
  | Index | 参数类型  | 参数说明           |
  | ----- | --------- | ------------------ |
  | 0     | uint256   | 当前轮次总奖励金   |
  | 1     | address[] | FOMO奖励获奖者列表 |
  | 2     | uint256[] | FOMO奖励奖金列表   |

##### 3. 获取幸运奖励信息

- 接口名称：`getLuckyRewardInfo(uint256 _stepIndex)`

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  | 参数名称     | 参数类型  | 参数说明       |
  | ------------ | --------- | -------------- |
  | `_stepIndex` | `uint256` | 第几轮(轮次数) |

- 返回

  ~~日志名称：`LuckyRewardInfo`~~

  返回方式：return
  
  | Index | 参数类型  | 参数说明         |
  | ----- | --------- | ---------------- |
  | 0     | uint256   | 当前轮次总奖励金 |
  | 1     | address[] | 幸运奖励获奖列表 |
  | 2     | uint256   | 幸运奖励奖金     |

##### 4. 获取信仰奖励信息

- 接口名称：`getFaithRewardInfo`

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  无
  
- 返回

  ~~日志名称：`FaithRewardInfo`~~

  | Index | 参数类型  | 参数说明         |
  | ----- | --------- | ---------------- |
  | 0     | uint256   | 信仰奖励总奖励金 |
  | 1     | address[] | 信仰奖励获奖列表 |
  | 2     | uint256[] | 信仰奖励奖金列表 |


#### 5. 个人中心界面

这里的数据直接返回一个Array

- 接口名称：`getFunderInfo()`

- 请求地址：Resonance合约地址

- 请求参数

  无

- 返回

  ~~日志名称：`FunderInfo`~~

  返回方式：return
  
  | Index | 参数名称                | 参数类型  | 参数说明            |
  | ----- | ----------------------- | --------- | ------------------- |
  | `0`   | `totalWithdrawToken`    | `uint256` | 可提取Token总数     |
  | `1`   | `totalWithdrawETH`      | `uint256` | 可提取ETH总数       |
  | `2`   | `inviteesNumber`        | `uint256` | 我的邀请人数        |
  | `3`   | `earnFromAff`           | `uint256` | 邀请所得金额        |
  | `4`   | `totalAmountInBuilding` | `uint256` | 组建期共投资金额    |
  | `5`   | `totalAmountInFunding`  | `uint256` | 募集期共投资ETH数量 |
  | `6`   | `totalLuckyReward`      | `uint256` | 幸运奖励总额        |
  | `7`   | `totalFissionReward`    | `uint256` | 裂变奖励总额        |
  | `8`   | `totalFOMOReward`       | `uint256` | FOMO奖励总额        |
  | `9`   | `totalFaithReward`      | `uint256` | 信仰奖励总额        |

#### 6. 查询某轮次Funders

返回**当前轮次**Funders的 Funders地址数组、组建期投入token数量的数组、募资期投入ETH数量的数组、邀请人数数组、推广所得数组，下标是一一对应的

- 接口名称：`getStepFunders`

- 请求地址：Resonance合约地址

- 请求参数

  | 请求参数   | 参数类型 | 参数说明 |
  | ---------- | -------- | -------- |
  | _stepIndex | uint256  | 轮次数   |

- 返回

  ~~日志名称：`StepFunders~~`

  返回方式：return
  
  | Index | 参数类型  | 参数说明                |
  | ----- | --------- | ----------------------- |
  | 0     | address[] | Funder地址              |
  | 1     | uint256[] | 在组建期投入的token数量 |
  | 2     | uint256[] | 在募资期投入的ETH数量   |
  | 3     | uint256[] | 邀请人数                |
  | 4     | uint256[] | 推广所得                |
  

#### 7. 查询msg.sender是否是共建者Builder

- 接口名称：isBuilder

- 请求地址：Resonance合约地址

- 请求参数：

  无

- 返回

  返回方式：return

  | Index | 参数类型 | 参数说明           |
  | ----- | -------- | ------------------ |
  | 0     | bool     | 调用者是否是共建者 |

#### 8. 查询msg.sender是否是募资者Funder

- 接口名称：isFunder

- 请求地址：Resonance合约地址

- 请求参数：

  无

- 返回

  返回方式：return

  | Index | 参数类型 | 参数说明           |
  | ----- | -------- | ------------------ |
  | 0     | bool     | 调用者是否是募资者 |

#### 9. 返回下一个区块高度的区块Hash

- 接口名称：getBlockHash

- 请求地址：Resonance合约地址

- 请求参数：

  无

- 返回

  返回方式：return

  | Index | 参数类型 | 参数说明           |
  | ----- | -------- | ------------------ |
  | 0     | bytes32  | 下个高度的区块hash |

#### 10. 查询所有参与共振的用户地址(只有管理员能调用)

- 接口名称：getResonances

- 请求地址：Resonance合约地址

- 请求参数：

  无

- 返回

  ~~日志名称：GetResonances~~

  | Index | 参数类型  | 参数说明                       |
  | ----- | --------- | ------------------------------ |
  | 0     | address[] | 参与共振的所有用户数组(未去重) |

#### 11. 查询单个用户在共振中投入的ETH的总量(只有管理员能调用)

- 接口名称：getFunderTotalRaised

- 请求地址：Resonance合约地址

- 请求参数：

  | 请求参数 | 参数类型 | 参数说明 |
  | -------- | -------- | -------- |
  | _funder  | address  | 用户地址 |

- 返回

  ~~日志名称：FunderTotalRaised~~

  返回方式：return
  
  | Index | 参数类型 | 参数说明                     |
  | ----- | -------- | ---------------------------- |
  | 0     | uint256  | _funder在共振中投入的ETH总量 |


#### 12. 基金会查询剩余多少授权额度

- 接口名称：allowance

- 请求地址：ABCToken(或者ERC20) 合约地址

- 请求参数

  | 请求参数 | 参数类型 | 参数说明                  |
  | -------- | -------- | ------------------------- |
  | owner    | address  | Token拥有者               |
  | spender  | address  | 授权人地址(Resonance地址) |

- 返回

  返回方式：return

  | Index | 参数类型 | 参数说明 |
  | ----- | -------- | -------- |
  | 0     | uint256  | 授权额度 |

#### 13. 判断共振是否结束

- 接口名称：crowdsaleIsClosed

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  无

- 返回：

  无

#### 14. 查询共振是否结束

- 接口名称：getResonanceIsClosed

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  无

- 返回：

  返回类型：return

  | Index | 参数类型 | 参数说明     |
  | ----- | -------- | ------------ |
  | 0     | bool     | 共振是否结束 |


#### 15. 允许对ResonanceDataManage的写入权限

在部署合约之后，管理员需要调用这个方法，设置Resonance合约具有对ResonanceDataManage合约的数据的写入权限

- 接口名称：allowAccess

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  | 请求参数 | 参数类型 | 参数说明          |
  | -------- | -------- | ----------------- |
  | _addr    | address  | Resonance合约地址 |

- 返回：

  无

#### 16. 撤销对ResonanceDataManage的写入权限

撤销_addr对ResonanceDatamange的写入权限

- 接口名称：

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  | 请求参数 | 参数类型 | 参数说明         |
  | -------- | -------- | ---------------- |
  | _addr    | address  | 要撤销权限的地址 |

#### 17. 初始化第一轮次的部分参数

- 接口名称：initParamForFirstStep

- 请求地址：Resonance合约地址

- 请求参数：

  | 请求参数              | 参数类型        | 参数说明                     |
  | --------------------- | --------------- | ---------------------------- |
  | _newOwner             | address         | 基金会地址（合约新的所有者） |
  | _beneficiary          | address payable | 基金会收款地址               |
  | _initialFissionPerson | address         | 初始裂变者地址               |

- 返回参数：

  无

#### 18. 查询轮次是否结束

- 接口名称：currentStepIsClosed

- 请求地址：Resonance合约地址

- 请求参数：

  | 请求参数   | 参数类型 | 参数说明  |
  | ---------- | -------- | --------- |
  | _stepIndex | uint256  | 轮次Index |

- 返回参数：

  | Index | 参数类型 | 参数说明       |
  | ----- | -------- | -------------- |
  | 0     | bool     | 该轮次是否结束 |

#### 19. 查询当前轮次的开始时间

- 接口名称：getOpeningTime

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  无

- 返回参数：

  | Index | 参数类型 | 参数说明           |
  | ----- | -------- | ------------------ |
  | 0     | uint256  | 当前轮次的开始时间 |

#### 20. 查询当前轮次的募资目标

- 接口名称：getRaiseTarget

- 请求地址：Resonance合约地址

- 请求参数：

  | 请求参数   | 参数类型 | 参数说明  |
  | ---------- | -------- | --------- |
  | _stepIndex | uint256  | 轮次Index |

- 返回参数：

  | Index | 参数类型 | 参数说明       |
  | ----- | -------- | -------------- |
  | 0     | uint256  | 该轮次募资目标 |

#### 21. 共建期基金会转入Token

- 接口名称：transferToken

- 请求地址：Resonance合约地址

- 请求参数：

  无

- 返回参数：

  | Index | 参数类型 | 参数说明                  |
  | ----- | -------- | ------------------------- |
  | 0     | uint256  | 当前轮次转入Token是否成功 |

#### 22. 查询共振结束时的Step

- 接口名称：getResonanceClosedStep

- 请求地址：ResonanceDataManage合约地址

- 请求参数：

  无

- 返回

  | Index | 参数类型 | 参数说明         |
  | ----- | -------- | ---------------- |
  | 0     | uint256  | 共振结束时的轮次 |

#### 23. 发起退款

- 接口名称：refund

- 请求地址：Resonance合约地址

- 请求参数：

  无

- 返回：

  | Index | 参数类型 | 参数说明         |
  | ----- | -------- | ---------------- |
  | 0     | uint256  | 处理退款是否成功 |

#### 24. 查询funder的邀请人集合

- 接口名称：getInvitees

- 请求地址：Resonance合约地址

- 请求参数：

  | 请求参数 | 参数类型 | 参数说明   |
  | -------- | -------- | ---------- |
  | _funder  | address  | funder地址 |

- 返回：

  | Index | 参数类型  | 参数说明               |
  | ----- | --------- | ---------------------- |
  | 0     | address[] | funder的推广者地址集合 |

  